# 2026-01-16 会话记录

## 变更摘要

- 针对当前训练损失失衡问题，更新 `PLAN.md`：明确 topo 的数据驱动缩放（q80/q90）+ `log1p` 压缩、仅对 topo/manifold 使用 GradNorm、并设置 20% cosine warmup 的策略与验证步骤。
- 更新 `PROGRESS.md` 的当前关注点为上述损失稳定化计划。
- 落地拓扑损失稳定化策略：对 `L_topo` 进行分位数尺度归一化与 `log1p` 压缩，加入 GradNorm（仅 `L_manifold/L_topo`），并对 topo 权重施加 20% cosine warmup。
- 训练入口新增参数：`--topo_scale_quantile`、`--topo_warmup_frac`、`--gradnorm_scope`、`--disable_topo_log_compress`。
- 更新 `docs/methods.md` 与 `docs/workflow.md`，记录 topo 归一化/GradNorm/warmup 与新增指标字段。
- 新增 `scripts/submit_clg_ode_smoke.sh` 短跑模板（q_ai8 单卡），并在 `docs/workflow.md` 记录可选环境变量。
- 修复 GradNorm 报错：top-k 稀疏化改为乘法 mask 保留梯度，并在 GradNorm 中加入 requires-grad 守卫。
- 新增 `scripts/submit_clg_ode_smoke_now.sh` 一键提交脚本，并记录 smoke 结果与下一步决策到 `docs/reports/model_dev_log.md`。
- 记录新的 smoke 结果（job13697578），并移除完整训练脚本的 `#SBATCH -t` 时间限制。
- 合并 5-fold CLG-ODE 结果（fold0-4）并完成统计分析报告 `docs/reports/clg_ode_cv_merge_20260116.md`。
- 计算 identity mapping baseline 的测试集指标，并更新 `docs/reports/clg_ode_cv_merge_20260116.md` 的对比分析。
- 更新 `AGENTS.md`：新增独立 conda 环境与深度学习容器使用规范。
- 更新 `AGENTS.md`：规定 `sbatch` 或长时间容器训练需由用户提交。
- 新增 VectorLSTM 与 GNN baseline 训练脚本与提交模板，并更新 `docs/workflow.md` 与配置键说明。
- 修复 baseline 提交脚本在无系统 `python3` 环境下的路径解析失败：改用 conda python 调用 `scripts.render_paths`。
- 修复 VectorLSTM baseline 在单时间点样本导致的训练崩溃：训练/验证仅保留至少两次扫描的被试。
- 新增 CLG-ODE 残差跳连与全边 log-MSE 训练选项，并提供 fold0 快速对照 sbatch 模板。
- 汇总 10 组 CLG-ODE fold0 快速对照实验结果，并更新报告与模型开发日志。
- 追加残差约束与零边抑制选项（`residual_cap`/`lambda_zero_log`/`lambda_delta_log`），新增 fold0 快速对照脚本 D。
- 新增 fold0 快速对照批量提交脚本 `scripts/submit_clg_ode_fast_fold0_batch.sh`。
- 汇总扩展批量实验结果并更新对照报告与模型开发日志。
- 整理 VectorLSTM/GNN baseline 运行状态，记录超时未产出结果。
