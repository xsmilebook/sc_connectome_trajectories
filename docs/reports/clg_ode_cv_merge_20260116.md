# CLG-ODE 5-fold 结果合并与分析（2026-01-16）

## 数据来源与合并方式

- 结果来源（保持原始目录不变，仅做汇总分析）：
  - `outputs/results/clg_ode/runs/clg_ode_20260116_220834_job13697585`（fold0-3）
  - `outputs/results/clg_ode/runs/clg_ode_20260116_220835_job13697585`（fold4）
- 合并口径：从每个 fold 的 `clg_ode_results.json` 读取 `best_val_loss`、`test_loss` 与 `test_sc_metrics`；汇总为 5-fold 统计，不改动 `outputs/` 下任何文件。

## 分 fold 结果

| fold | run | best_val_loss | test_loss | sc_log_mse | sc_log_mae | sc_log_pearson | sc_log_pearson_pos | sc_log_pearson_topk | sc_log_pearson_sparse | ecc_l2 | ecc_pearson |
|---|---|---|---|---|---|---|---|---|---|---|---|
| 0 | clg_ode_20260116_220834_job13697585 | 0.439572 | 0.444663 | 2.009558 | 1.374935 | 0.163918 | 0.144874 | 0.076059 | 0.087860 | 642766.23 | 0.984056 |
| 1 | clg_ode_20260116_220834_job13697585 | 0.443118 | 0.443690 | 2.007640 | 1.374260 | 0.167164 | 0.149171 | 0.077679 | 0.090294 | 657024.47 | 0.983826 |
| 2 | clg_ode_20260116_220834_job13697585 | 0.449265 | 0.443712 | 2.003855 | 1.372971 | 0.164899 | 0.145431 | 0.076132 | 0.088194 | 652275.70 | 0.983934 |
| 3 | clg_ode_20260116_220834_job13697585 | 0.440039 | 0.443529 | 1.999740 | 1.371507 | 0.163741 | 0.143170 | 0.075411 | 0.087161 | 635654.94 | 0.984155 |
| 4 | clg_ode_20260116_220835_job13697585 | 0.450141 | 0.444481 | 2.030330 | 1.382252 | 0.161185 | 0.143233 | 0.074717 | 0.087363 | 636601.88 | 0.983860 |

## 统计汇总（5-fold）

| metric | mean | std | min | max |
|---|---|---|---|---|
| best_val_loss | 0.444427 | 0.004486 | 0.439572 | 0.450141 |
| test_loss | 0.444015 | 0.000463 | 0.443529 | 0.444663 |
| sc_log_mse | 2.010224 | 0.010601 | 1.999740 | 2.030330 |
| sc_log_mae | 1.375185 | 0.003722 | 1.371507 | 1.382252 |
| sc_log_pearson | 0.164181 | 0.001932 | 0.161185 | 0.167164 |
| sc_log_pearson_pos | 0.145176 | 0.002187 | 0.143170 | 0.149171 |
| sc_log_pearson_topk | 0.076000 | 0.000983 | 0.074717 | 0.077679 |
| sc_log_pearson_sparse | 0.088175 | 0.001120 | 0.087161 | 0.090294 |
| ecc_l2 | 644864.64 | 8488.58 | 635654.94 | 657024.47 |
| ecc_pearson | 0.983966 | 0.000123 | 0.983826 | 0.984155 |

## Identity mapping baseline（测试集）

定义：使用基线结构连接矩阵（t0）直接作为预测，目标为后续时间点（t1）；若仅有单次扫描，则按 t0→t0 计算。测试集划分与 CLG-ODE 一致（random_state=42，20% subject split），并与训练相同地过滤缺失形态学的扫描。

| metric | identity_baseline | clg_ode_5fold_mean |
|---|---|---|
| sc_log_mse | 0.126836 | 2.010224 |
| sc_log_mae | 0.101258 | 1.375185 |
| sc_log_pearson | 0.864430 | 0.164181 |
| sc_log_pearson_pos | 0.822734 | 0.145176 |
| sc_log_pearson_topk | 0.574224 | 0.076000 |
| sc_log_pearson_sparse | 0.560635 | 0.088175 |
| ecc_l2 | 10929.32 | 644864.64 |
| ecc_pearson | 0.998740 | 0.983966 |

## 结果解读

- `test_loss` 的跨 fold 波动极小（std 4.6e-4），表明整体训练/泛化稳定性较高。
- `best_val_loss` 的波动略大（std 4.5e-3），fold2 与 fold4 偏高，提示数据划分差异对验证集更敏感。
- SC 预测相关性（`sc_log_pearson`/`sc_log_pearson_pos`）集中在 0.16 左右，差异小但整体偏低，说明在当前设置下结构相关性仍有提升空间。
- `sc_log_pearson_topk` 与 `sc_log_pearson_sparse` 略高于全量相关，符合稀疏化后相关性更稳定的预期。
- `ecc_pearson` 非常稳定（约 0.984），但 `ecc_l2` 存在一定方差，说明整体拓扑相似度一致，幅值尺度仍有轻微分歧。
- fold4 在 `sc_log_mse` 与相关指标上略差，且对应 `best_val_loss` 较高，建议后续关注该划分的训练/数据分布差异。
- identity mapping baseline 在全部 SC 指标和 ECC 指标上显著优于当前 CLG-ODE 均值，提示模型预测尚未超过简单的“基线即预测”基线，需要进一步优化模型或损失权重配置。

## 结论

当前 5-fold 合并结果显示模型在测试损失与 ECC 指标上稳定一致，但 SC 相关性指标整体偏低，后续优化应优先关注提升 SC 相关性与缩小 fold 间验证差异。
